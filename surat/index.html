<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Form Surat</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 2rem;
      background-color: #f0f0f0;
    }
    form {
      max-width: 500px;
      margin: auto;
      background: white;
      padding: 2rem;
      border-radius: 10px;
    }
    input, select, button {
      width: 100%;
      padding: 10px;
      margin: 0.5rem 0;
      border-radius: 5px;
      border: 1px solid #ccc;
    }
    button {
      background-color: #002db3;
      color: white;
      font-weight: bold;
      cursor: pointer;
    }
    .status {
      margin-top: 10px;
      font-size: 0.9em;
    }
  </style>
</head>
<body>

  <form id="suratForm">
    <h2>Surat Generator</h2>
    <input type="text" name="nama" placeholder="Nama" required />
    <input type="text" name="nip" placeholder="NIP" required />
    <input type="text" name="jabatan" placeholder="Jabatan" required />
    <input type="text" name="isi" placeholder="Isi Surat" required />
    <input type="date" name="tanggal" required />
    <button type="submit">Buat Surat</button>
    <p class="status" id="statusText"></p>
  </form>

  <script>
    const form = document.getElementById("suratForm");
    const statusText = document.getElementById("statusText");

    form.addEventListener("submit", async function (e) {
      e.preventDefault();
      statusText.textContent = "Memproses surat...";

      const data = {
        nama: form.nama.value,
        nip: form.nip.value,
        jabatan: form.jabatan.value,
        isi: form.isi.value,
        tanggal: form.tanggal.value
      };

      try {
        // Gunakan CORS proxy agar bisa fetch ke Apps Script dari GitHub Pages
        const scriptURL = "https://script.google.com/macros/s/AKfycbz5Mou8InBaT9pw-u9s1vJdndzogXY6xZPHRQNcLK5a-vCzFHGhD-avBXiEKx1cu-rO/exec";
        const proxyURL = "https://corsproxy.io/?" + encodeURIComponent(scriptURL);

        const response = await fetch(proxyURL, {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(data)
        });

        const result = await response.text();
        statusText.innerHTML = `✅ Surat berhasil dibuat: <a href="${result}" target="_blank">${result}</a>`;
      } catch (err) {
        statusText.textContent = "❌ Gagal membuat surat: " + err;
      }
    });
  </script>

</body>
</html>
